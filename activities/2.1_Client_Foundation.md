1# CÃ´ng viá»‡c: 2.1 - XÃ¢y dá»±ng Ná»n táº£ng Client cho Provider

- **NgÆ°á»i thá»±c hiá»‡n (Implemented by):** [Gemini]
- **LiÃªn quan Ä‘áº¿n Giai Ä‘oáº¡n (Related to Phase):** [2]

---

## ğŸ“ Káº¿ hoáº¡ch thá»±c thi (ÄÃ£ Ä‘iá»u chá»‰nh theo Hiáº¿n phÃ¡p)

**1. Má»¥c tiÃªu (Goal):**
*   XÃ¢y dá»±ng ná»n táº£ng vÃ  sÆ°á»n cho cÃ´ng cá»¥ dÃ²ng lá»‡nh (CLI) cá»§a Provider, cho phÃ©p há» tÆ°Æ¡ng tÃ¡c vá»›i máº¡ng lÆ°á»›i NodeLink.

**2. LÃ½ do (Reason):**
*   TuÃ¢n thá»§ "Hiáº¿n phÃ¡p dá»± Ã¡n" báº±ng cÃ¡ch Æ°u tiÃªn phÃ¡t triá»ƒn CLI Ä‘á»ƒ Ä‘áº©y nhanh tiáº¿n Ä‘á»™. BÆ°á»›c nÃ y táº¡o ra cÃ´ng cá»¥ cá»‘t lÃµi Ä‘á»ƒ Provider cÃ³ thá»ƒ Ä‘Äƒng kÃ½ vÃ  láº¯ng nghe cÃ¡c job.

**3. CÃ¡c bÆ°á»›c thá»±c hiá»‡n (Steps):**
*   **BÆ°á»›c 1: Táº¡o cáº¥u trÃºc file cho CLI:**
    *   Táº¡o thÆ° má»¥c `client/`.
    *   Táº¡o file chÃ­nh `client/provider-cli.ts` Ä‘á»ƒ xá»­ lÃ½ logic cho cÃ¡c lá»‡nh CLI.
    *   Táº¡o file `client/common.ts` Ä‘á»ƒ chá»©a code káº¿t ná»‘i Solana dÃ¹ng chung.
*   **BÆ°á»›c 2: PhÃ¢n tÃ­ch vÃ  CÃ i Ä‘áº·t Dependencies:**
    *   Kiá»ƒm tra `package.json` vÃ  thÃªm cÃ¡c thÆ° viá»‡n cáº§n thiáº¿t cho viá»‡c xÃ¢y dá»±ng CLI báº±ng Node.js, vÃ­ dá»¥ nhÆ° `commander` Ä‘á»ƒ xá»­ lÃ½ tham sá»‘ dÃ²ng lá»‡nh.
    *   Cháº¡y `npm install` Ä‘á»ƒ cÃ i Ä‘áº·t.
*   **BÆ°á»›c 3: Viáº¿t code ná»n táº£ng trong `common.ts`:**
    *   Implement cÃ¡c hÃ m Ä‘á»ƒ káº¿t ná»‘i máº¡ng, láº¥y Anchor program, vÃ  táº£i vÃ­ tá»« file.
*   **BÆ°á»›c 4: XÃ¢y dá»±ng sÆ°á»n CLI trong `provider-cli.ts`:**
    *   Sá»­ dá»¥ng thÆ° viá»‡n `commander` Ä‘á»ƒ Ä‘á»‹nh nghÄ©a cáº¥u trÃºc lá»‡nh ban Ä‘áº§u, vÃ­ dá»¥ nhÆ° lá»‡nh `register`.

---
## ğŸš€ QuÃ¡ trÃ¬nh thá»±c hiá»‡n (Implementation Process)

*Quy trÃ¬nh nÃ y mÃ´ táº£ chi tiáº¿t cÃ¡ch cÃ¡c bÆ°á»›c trong káº¿ hoáº¡ch sáº½ Ä‘Æ°á»£c thá»±c thi. TÃ´i sáº½ ghi láº¡i káº¿t quáº£ cá»§a tá»«ng bÆ°á»›c vÃ o Ä‘Ã¢y sau khi Ä‘Æ°á»£c báº¡n cho phÃ©p thá»±c hiá»‡n.*

**1. Khá»Ÿi táº¡o mÃ´i trÆ°á»ng:**
   - **HÃ nh Ä‘á»™ng:** Thá»±c thi lá»‡nh `mkdir -p client && touch client/provider-cli.ts client/common.ts`.
   - **Má»¥c Ä‘Ã­ch:** Táº¡o thÆ° má»¥c `client` vÃ  cÃ¡c file sÆ°á»n `provider-cli.ts` (cho logic CLI) vÃ  `common.ts` (cho cÃ¡c hÃ m dÃ¹ng chung).

**2. Quáº£n lÃ½ Dependencies:**
   - **HÃ nh Ä‘á»™ng:** Äá»c file `package.json` Ä‘á»ƒ kiá»ƒm tra cÃ¡c thÆ° viá»‡n Ä‘Ã£ cÃ³.
   - **HÃ nh Ä‘á»™ng:** ThÃªm thÆ° viá»‡n `commander` vÃ o `devDependencies` Ä‘á»ƒ xá»­ lÃ½ tham sá»‘ dÃ²ng lá»‡nh.
   - **HÃ nh Ä‘á»™ng:** Cháº¡y lá»‡nh `npm install` Ä‘á»ƒ táº£i vÃ  cÃ i Ä‘áº·t thÆ° viá»‡n má»›i.
   - **Má»¥c Ä‘Ã­ch:** Chuáº©n bá»‹ cÃ¡c cÃ´ng cá»¥ cáº§n thiáº¿t Ä‘á»ƒ xÃ¢y dá»±ng má»™t á»©ng dá»¥ng CLI chuyÃªn nghiá»‡p.

**3. XÃ¢y dá»±ng Module `common.ts`:**
   - **HÃ nh Ä‘á»™ng:** Viáº¿t code cho file `client/common.ts`.
   - **Chi tiáº¿t:**
     - Import cÃ¡c lá»›p cáº§n thiáº¿t tá»« `@solana/web3.js` vÃ  `@coral-xyz/anchor`.
     - Viáº¿t hÃ m `getConnection()`: Tráº£ vá» má»™t Ä‘á»‘i tÆ°á»£ng `Connection` Ä‘Ã£ Ä‘Æ°á»£c cáº¥u hÃ¬nh Ä‘á»ƒ káº¿t ná»‘i tá»›i Solana Devnet.
     - Viáº¿t hÃ m `getWallet(keypairPath)`: Äá»c má»™t file keypair tá»« Ä‘Æ°á»ng dáº«n Ä‘Æ°á»£c cung cáº¥p vÃ  tráº£ vá» má»™t Ä‘á»‘i tÆ°á»£ng `Keypair` Ä‘á»ƒ kÃ½ giao dá»‹ch.
     - Viáº¿t hÃ m `getProgram(wallet)`: Khá»Ÿi táº¡o vÃ  tráº£ vá» Ä‘á»‘i tÆ°á»£ng `Program` cá»§a Anchor, lÃ  cáº§u ná»‘i Ä‘á»ƒ gá»i cÃ¡c instruction cá»§a smart contract.
   - **Má»¥c Ä‘Ã­ch:** Táº¡o ra má»™t lá»›p trá»«u tÆ°á»£ng (abstraction layer) Ä‘á»ƒ dá»… dÃ ng tÆ°Æ¡ng tÃ¡c vá»›i Solana vÃ  smart contract tá»« nhiá»u nÆ¡i trong client.

**4. XÃ¢y dá»±ng sÆ°á»n CLI trong `provider-cli.ts`:**
   - **HÃ nh Ä‘á»™ng:** Viáº¿t code cho file `client/provider-cli.ts`.
   - **Chi tiáº¿t:**
     - Import `Command` tá»« `commander` vÃ  cÃ¡c hÃ m tá»« `common.ts`.
     - Khá»Ÿi táº¡o chÆ°Æ¡ng trÃ¬nh CLI: `const program = new Command();`.
     - Äá»‹nh nghÄ©a lá»‡nh `register` cÃ¹ng vá»›i cÃ¡c tÃ¹y chá»n (options) nhÆ° `--keypair <path>` Ä‘á»ƒ chá»‰ Ä‘á»‹nh vÃ­ cá»§a provider.
     - Trong hÃ m `.action()` cá»§a lá»‡nh `register`, sáº½ gá»i cÃ¡c hÃ m tá»« `common.ts` vÃ  log ra thÃ´ng bÃ¡o xÃ¡c nháº­n Ä‘á»ƒ kiá»ƒm tra.
     - ThÃªm `program.parse(process.argv);` á»Ÿ cuá»‘i file Ä‘á»ƒ khá»Ÿi cháº¡y CLI.
   - **Má»¥c Ä‘Ã­ch:** Táº¡o ra giao diá»‡n dÃ²ng lá»‡nh Ä‘áº§u tiÃªn, cho phÃ©p ngÆ°á»i dÃ¹ng gá»i lá»‡nh `register` vÃ  Ä‘áº·t ná»n mÃ³ng cho viá»‡c thÃªm cÃ¡c lá»‡nh khÃ¡c sau nÃ y.
